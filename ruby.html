<!DOCTYPE html>
<html>
  <head>
    <title>Ruby</title>
    <meta charset="utf-8" />
    <script src="slides.js"></script>
  </head>

  <body style="display: none">
    <section class="slides layout-regular template-flatschool">

      <article>
        <h1 class="centered">
          Ruby Syntax
        </h1>
        <div class="source">
          Alexander Pavlenko, <a href="http://twitter.com/Alerticus">@Alerticus</a><br/>
          <a href="mailto:alexander.pavlenko@flatstack.com">alexander.pavlenko@flatstack.com</a>
        </div>
      </article>

      <article>
        <h3>
          Everything is an object.
        </h3>
        <p>
          What is not an object, is a method call.
        </p>
        <pre>
puts "Hello World!"</pre>
        <pre>
1 + 2</pre>
<pre>
> 1.class
=> Fixnum
> nil.class
=> NilClass 
> nil.class.superclass
=> Object</pre>
      </article>

      <article>
        <h3>Flow is under control.</h3>
        <div class="build">
          <pre>
if value
  'anything'
elsif value.nil?
  'nil'
else
  'false'
end</pre>
          <pre>
case value
when 'green'
  :win
when 'red'
  :bad
else
  :fault
end</pre>
        </div>
      </article>

      <article>
        <h3>Flow is under control.</h3>
        <div class="build">
          <pre>
for i in 1.upto(5)
  next if i == 1
  break if i == 5
  puts i
end</pre>
          <pre>
while str = gets
  if str.strip == 'stop this!'
    puts 'sorry'
    break
  end
  puts str
end</pre>
        </div>
      </article>

      <article>
        <h3>Expression over cryptic.</h3>
        <div class="build">
          <pre>
unless value  # equals to: if !value
  # value is false or nil
  do_panic and return if value.nil?
else
  'your anything'
end</pre>
          <pre>
"hello".upcase and "hello".upcase!</pre>
          <pre>
one, two, three = 1, 2, 3
one, two = two, one
one = two = three</pre>
        </div>
      </article>

      <article>
        <h3>Everything has a value.</h3>
        <pre>
def method
  if true
    true && 'result'
  else
    'this'
  end
end
result = method</pre>
      </article>

      <article>
        <h3>Our friends:</h3>
        <pre>
[
  [1, 2, 3],
  1..3,
  %w(a b c),
  '%5s' % 'pad',
  {
    :user => 'Timmy',
    :ability => :"ta-da!"
  }
].each do |item|
  puts item.class, item.inspect
end</pre>
        <h2>And their names are…</h2>
      </article>

      <article>
        <h3>Object</h3>
        <h4>Summoning</h4>
        <pre>
Object.new</pre>
        <h4>Abilities</h4>
        <ul>
          <li>nil?</li>
          <li>inspect</li>
          <li>object_id</li>
          <li>clone</li>
          <li>tap</li>
          <li>methods</li>
        </ul>
      </article>
      
      <article>
        <h3>Number</h3>
        <h4>Summoning</h4>
        <pre>
1, 2, 3, 5…
something.to_i</pre>
        <h4>Abilities</h4>
        <ul>
          <li>to_s</li>
          <li>even? or odd?</li>
          <li>upto</li>
          <li>downto</li>
          <li>times</li>
        </ul>
      </article>
      
      <article>
        <h3>Range</h3>
        <h4>Summoning</h4>
        <pre>
1..5
1...5</pre>
        <h4>Abilities</h4>
        <ul>
          <li>to_a</li>
          <li>first</li>
          <li>last</li>
        </ul>
      </article>
      
      <article>
        <h3>String</h3>
        <h4>Summoning</h4>
        <pre>
"interpolatable #{41 + 1}"
%Q{interpolatable #{41 + 1}}
'as is'
%q{as is}

<<-ANYTEXT
multiline,
interpolatable #{41 + 1}
ANYTEXT

'Z' * 5
'%s: %i, %i' % ['look', 4, 2, 'it\'ll be ignored']

something.to_s</pre>
      </article>
      
      <article>
        <h3>String</h3>
        <h4>Abilities</h4>
        <ul>
          <li>size and empty?</li>
          <li>upcase and downcase</li>
          <li>lines, chars, bytes</li>
          <li>strip</li>
          <li>squeeze</li>
          <li>slice</li>
        </ul>
      </article>
      
      <article>
        <h3>Symbol</h3>
        <h4>Summoning</h4>
        <pre>
:normal
:"-W1eRd#{41 + 1}"
something.to_sym</pre>
        <h4>Abilities</h4>
        <ul>
          <li>==</li>
          <li>to_proc</li>
        </ul>
      </article>
      
      <article>
        <h3>Array</h3>
        <h4>Summoning</h4>
        <pre>
%W{interpolatable strings #{41 + 1}}
%w{strings as is}
[item1, item2, 3, 4, 'five']
Array.new(5) {|index| index ** index }
something.to_a</pre>
      </article>

      <article>
        <h3>Array</h3>
        <h4>Abilities</h4>
        <ul>
          <li>size and empty?</li>
          <li>push, pop, shift, unshift</li>
          <li>delete and delete_at</li>
          <li>reverse and rotate</li>
          <li>sort and sort_by</li>
          <li>group_by</li>
          <li>flatten</li>
          <li>shuffle</li>
          <li>| and &amp;</li>
        </ul>
      </article>
      
      <article>
        <h3>Hash</h3>
        <h4>Summoning</h4>
        <pre>
{:key => value, :key2 => value}
method(:key => value, :key2 => value)
Hash.new
something.to_hash</pre>
        <h4>Abilities</h4>
        <ul>
          <li>size and empty?</li>
          <li>keys and values</li>
          <li>key? or value?</li>
          <li>merge</li>
        </ul>
      </article>

      <article>
        <h3>Common «operators»</h3>
        <ul>
          <li><code>collection &lt;&lt; value</code></li>
          <li><code>collection[key]</code></li>
          <li><code>collection[key] = value</code></li>
          <li><code>value =~ /regexp/</code></li>
        </ul>
        <h2>Actually are…</h2>
      </article>

      <article>
        <h3>Methods</h3>
        <ul>
          <li><code>collection.send(:&lt;&lt;, value)</code></li>
          <li><code>collection.send(:[], key)</code></li>
          <li><code>collection.send(:[]=, value)</code></li>
          <li><code>value.send(:=~, /regexp/)</code></li>
        </ul>
      </article>

      <article>
        <h3>Block</h3>
        <div class="build">
          <div>
            <h4>From the outside.</h4>
            <pre>
method do |locals|
  do_something_with locals
end
method {|locals| do_something_with locals }</pre>
          </div>
          <div>
            <h4>From the inside.</h4>
            <pre>
def method
  value = 41 + 1
  something_done = yield(value) if block_given?
  value
end</pre>
          </div>
        </div>
      </article>

      <article>
        <h3>Iterator</h3>
        <pre>
collection.each do |elem|
  do_anything_with elem
end</pre>
         <ul>
           <li>each</li>
           <li>reverse_each</li>
           <strong>Array</strong>
           <li>each_index, each_entry</li>
           <li>each_with_index</li>
           <li>each_slice</li>
           <strong>Hash</strong>
           <li>each_key, each_value</li>
           <li>each_pair</li>
         </ul>
      </article>

      <article>
        <h3>Iterator</h3>
        <pre>
collection.inject([]) do |accumulator, elem|
  accumulator << elem.mess_it if stars_shine?
  accumulator
end.map do |elem|   # same: map(&:to_hedgehog)
  elem.to_hedgehog  #
end.select do |elem|
  elem && elem.hedgehog?
end.reject do |elem|
  elem.hedgehog?
end</pre>
      </article>

      <article>
        <h3>Class</h3>
        <pre>
class Base
  @@class_var = 1
  @class_instance_var = 2
  SOMETHING_STATIC = :constant
  attr_accessor :instance_var

  def initialize
    @instance_var = 3
  end

  def instance_method
    @instance_var += 1
  end

  def self.class_method
    @class_instance_var += 1
  end
end</pre>
      </article>

      <article>
        <h3>Module</h3>
        <pre>
module OtherModule
  def simple; 'is simple'; end
end
module SomeModule
  extend OtherModule
  def self.included(base)
    base.send(:extend, ClassMethods)
    base.send(:include, InstanceMethods)
    puts base.name
  end
  module ClassMethods
    def cm; puts 'class method'; end
  end
  module InstanceMethods
    def im; puts 'instance method'; end
  end
end</pre>
         <p>Tip: have a look at ActiveSupport::Concern</p>
      </article>

      <article>
        <h3>Class</h3>
        <pre>
class Special < Base
  include SomeModule
  def initialize
    super
    @instance_var *= 2
  end
  def can_this
    @@class_var += 1
  end
  def nil_here
    @class_instance_var
  end
  def error_here
    @@uninitialized_class_var
  end
end</pre>
      </article>

      <article>
        <h3>Exceptions handling</h3>
        <pre>
def method
  all_bad = true
  begin
    raise Exception.new('error in block') if all_bad
    puts 'ok, block done'
  rescue Exception => ex
    puts ex.message
    all_bad = false
    retry
  ensure
    puts 'finalizer'
    raise 'ops!'
  end
  puts 'unreachable'
rescue => ex
  puts "#{ex.class}: #{ex.message}"
end</pre>
      </article>

      <article>
        <h1 class="centered">Tools</h1>
      </article>

      <article>
        <h3>Interactive Ruby Shell</h3>
        <pre>
$ irb
ruby-1.9.2-p290 :001 > puts 'here is it'
here is it
 => nil
ruby-1.9.2-p290 :002 > 'scary
ruby-1.9.2-p290 :003'> multiline'
 => "scary\nmultiline"
ruby-1.9.2-p290 :004 > exit</pre>
      </article>

      <article>
        <h3>Gems</h3>
        <p>
          Builds: <a href="http://rubygems.org/">http://rubygems.org/</a> <br/>
          Sources: <a href="http://github.com/">http://github.com/</a>
        </p>
        <pre>
$ gem install yajl-ruby
$ irb
ruby-1.9.2-p290 :001 > require 'yajl'
 => true 
ruby-1.9.2-p290 :002 > Yajl::Parser.parse('"this"')
 => "this"
        </pre>
      </article>

      <article>
        <h1 class="centered">Homework</h1>
      </article>

      <article>
        <h3>Ruby Koans</h3>
        <q>
          Learn the Ruby language, syntax, structure, and some common functions and libraries.
        </q>
        <div class="author">
          <a href="http://rubykoans.com/">rubykoans.com/</a>
        </div>
      </article>

      <article>
        <h3>Ruby Doc</h3>
        <q>
          <img src="images/logo-rubydoc.gif" />
        </q>
        <div class="author">
          <a href="http://www.ruby-doc.org/core-1.9.2/">www.ruby-doc.org/core-1.9.2/</a>
        </div>
      </article>

      <article>
        <h3>For the further questions:</h3>
        <p>
          Google Groups thread:
          <a href="https://groups.google.com/forum/#!topic/fs-courses/TLFEOJbJl6I">
            http://goo.gl/ZFcLK
          </a>
        </p>
        <h2>Thanks for the attention.</h2>
      </article>

    </section>
  </body>
</html>
